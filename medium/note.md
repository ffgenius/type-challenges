## æ¡ä»¶ç±»å‹åˆ†å‘

å½“ä¸€ä¸ªå¯¹è±¡ä¸ºè”åˆç±»å‹æ—¶ï¼Œæ¡ä»¶ç±»å‹ä¼šåˆ†å‘ï¼Œå³ä¼šé’ˆå¯¹è”åˆç±»å‹çš„æ¯ä¸ªæˆå‘˜è¿›è¡Œç±»å‹åˆ¤æ–­ã€‚

**ä¸€å¥è¯æ€»è§„åˆ™ï¼ˆæ ¸å¿ƒï¼‰**

åªæœ‰å½“ã€Œè£¸çš„ç±»å‹å‚æ•°ã€å‡ºç°åœ¨ extends å·¦è¾¹æ—¶ï¼Œæ‰ä¼šå¯¹ union åˆ†å‘ (Naked Type)
ğŸ‘‰ åªè¦ T åŸå°ä¸åŠ¨ç«™åœ¨ extends å·¦è¾¹ï¼Œå®ƒå°±æ˜¯è£¸çš„

```ts
type A = T extends U ? A : B   // âœ… åˆ†å‘
```

```ts
type A = [X] extends [U] ? A : B   // âŒ ä¸åˆ†å‘
```
### ä¸€ã€âœ… ä¼šåˆ†å‘ï¼ˆDistributiveï¼‰

**1ï¸âƒ£ è£¸ T åœ¨ extends å·¦ä¾§ï¼ˆæœ€å¸¸è§ï¼‰**

```ts
type D<T> = T extends string ? 1 : 2
```

`D<'a' | 1>`
â†’ `D<'a'> | D<1>`
â†’ `1 | 2`

---

**2ï¸âƒ£ T extends any / unknown**

```ts
type D<T> = T extends unknown ? T[] : never
```

---

`D<string | number>`
â†’ `string[] | number[]`

ğŸ“Œ any / unknown **åªæ˜¯ä¸ºäº†è§¦å‘åˆ†å‘**

--- 

**3ï¸âƒ£ å¤šåˆ†æ”¯ä¹Ÿç…§æ ·åˆ†å‘**

```ts
type D<T> =
  T extends string ? 's'
  : T extends number ? 'n'
  : 'o'
```

### äºŒã€âŒ ä¸ä¼šåˆ†å‘ï¼ˆNon-distributiveï¼‰

**4ï¸âƒ£ T è¢«åŒ…äº†ä¸€å±‚ï¼ˆ99% çš„å‘ï¼‰**

```ts
type ND<T> = [T] extends [string] ? 1 : 2
```

`ND<'a' | 1>`
â†’ `2`        âŒ ä¸åˆ†å‘

ğŸ“Œ ä¸€æ—¦åŒ…è¿› tuple / objectï¼Œå°±**å¤±å»åˆ†å‘æ€§**

---

**5ï¸âƒ£ keyof T extends ...**

```ts
type ND<T> = keyof T extends never ? 1 : 2
```

`ND<{a} | {b}>`
â†’ `2`        âŒ ä¸åˆ†å‘

ğŸ‘‰ extends å·¦è¾¹å·²ç»ä¸æ˜¯ è£¸ T

---

**6ï¸âƒ£ T[K] extends ...ï¼ˆå±æ€§çº§åˆ¤æ–­ï¼‰**

```ts
type ND<T> = {
  [K in keyof T]: T[K] extends string ? 1 : 2
}
```

ğŸ“Œ æ˜ å°„ç±»å‹é‡Œçš„ extends ä¸åˆ†å‘ union

---

**7ï¸âƒ£ T & {} / T | {}**

```ts
type ND<T> = (T & {}) extends string ? 1 : 2
```

âŒ ä¸åˆ†å‘
ğŸ‘‰ å› ä¸ºå·¦è¾¹å·²ç»ä¸æ˜¯è£¸ `T`

---

### ä¸‰ã€å¼ºåˆ¶ã€Œå¼€ / å…³ã€åˆ†å‘çš„æŠ€å·§

**âœ… å¼ºåˆ¶å¼€å¯åˆ†å‘ï¼ˆä½ åœ¨ DeepReadonly é‡Œç”¨çš„ï¼‰**

```ts
type ForceDistribute<T> =
  T extends unknown
    ? ''/* åˆ†å‘åçš„é€»è¾‘ */
: never
```

**âŒ å¼ºåˆ¶å…³é—­åˆ†å‘ï¼ˆéå¸¸å¸¸ç”¨ï¼‰**

```ts
type NoDistribute<T> =
  [T] extends [any] ? '' /* æ•´ä½“åˆ¤æ–­ */ : never
```

## keyof T extends never

### ä¸€ã€keyof T åˆ°åº•è¡¨ç¤ºä»€ä¹ˆï¼Ÿ

ğŸ‘‰ åˆ¤æ–­ Tã€Œè¿˜æœ‰æ²¡æœ‰å¯ä»¥ç»§ç»­é€’å½’çš„ç»“æ„ã€

**keyof T = ç±»å‹ T çš„æ‰€æœ‰å¯è®¿é—®å±æ€§åçš„è”åˆç±»å‹**

```ts
type A = keyof { a: number }        // 'a'
type A = keyof { a: number, b: 1 }  // 'a' | 'b'
type A = keyof [1, 2]               // '0' | '1' | 'length' | ...
type A = keyof string[]             // number | 'length' | ...
```

### äºŒã€ä»€ä¹ˆæ—¶å€™ keyof T æ˜¯ neverï¼Ÿ

| T                  | `keyof T` |
| ------------------ | --------- |
| `string`           | `never`   |
| `number`           | `never`   |
| `boolean`          | `never`   |
| `bigint`           | `never`   |
| `symbol`           | `never`   |
| `null / undefined` | `never`   |
| `'abc'`            | `never`   |
| `true`             | `never`   |
| `() => void`       | `never`   |


### ä¸‰ã€æ‰€ä»¥ keyof T extends never åœ¨å¹²å˜›ï¼Ÿ

æ„æ€æ˜¯ï¼š**å¦‚æœ T æ²¡æœ‰ä»»ä½• keyï¼ˆä¸å¯å†æ‹†ï¼‰ â†’ é€’å½’ç»ˆæ­¢**

æ¢æˆå¤§ç™½è¯å°±æ˜¯ï¼š**ğŸ§  â€œå·²ç»æ˜¯å¶å­èŠ‚ç‚¹äº†ï¼Œåˆ«å†å¾€ä¸‹ Deep äº†â€**

## `O | O1` vs `O & O1`

| å¯¹æ¯”é¡¹            | `O \| O1`ï¼ˆè”åˆï¼‰        | `O & O1`ï¼ˆäº¤å‰ï¼‰          |
| -------------- | -------------------- | --------------------- |
| æœ¬è´¨             | **ä¸ç¡®å®šæ˜¯å“ªä¸€ä¸ª**          | **ä¸€å®šåŒæ—¶æ˜¯ä¸¤ä¸ª**           |
| å¿ƒæ™ºæ¨¡å‹           | *å¯èƒ½æ€§*                | *å åŠ èƒ½åŠ›*                |
| èƒ½ç›´æ¥è®¿é—®çš„å±æ€§       | **å…±æœ‰ key**           | **æ‰€æœ‰ key**            |
| `keyof` ç»“æœ     | `keyof O & keyof O1` | `keyof O \| keyof O1` |
| æ˜¯å¦éœ€è¦ narrowing | å¿…é¡»                   | ä¸éœ€è¦                   |
| å¸¸è§ç”¨é€”           | API è¿”å›ã€å¤šæ€            | Props åˆå¹¶ã€èƒ½åŠ›å¢å¼º         |

